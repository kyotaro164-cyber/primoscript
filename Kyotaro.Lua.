local button = script.Parent
local player = game.Players.LocalPlayer
local lighting = game:GetService("Lighting")
local userSettings = UserSettings():GetService("UserGameSettings")

local antiLag = false

button.Text = "ANTI-LAG: OFF"

local function applyAntiLag()
	-- Lower graphics
	userSettings.SavedQualityLevel = Enum.SavedQualitySetting.QualityLevel1
	
	-- Lighting optimization
	lighting.GlobalShadows = false
	lighting.FogEnd = 100000
	lighting.Brightness = 1
	
	-- Remove heavy effects
	for _, v in pairs(lighting:GetChildren()) do
		if v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("SunRaysEffect") or v:IsA("ColorCorrectionEffect") then
			v.Enabled = false
		end
	end
end

local function removeAntiLag()
	-- Let player control graphics again
	userSettings.SavedQualityLevel = Enum.SavedQualitySetting.Automatic
	
	lighting.GlobalShadows = true
end

button.MouseButton1Click:Connect(function()
	if antiLag then
		removeAntiLag()
		button.Text = "ANTI-LAG: OFF"
		antiLag = false
	else
		applyAntiLag()
		button.Text = "ANTI-LAG: ON"
		antiLag = true
	end
end)
